%!PS-Adobe-1.0
%%Title: Henon
%%Creator: vi
%%CreationDate: 31-06-04
%%Pages: 1
%%BoundingBox: 0 0 596 842
%%EndComments

% Author: Tim Vaughan

/A 1.4 def
/B 0.3 def
/NUMITER 100000 def

/pixelside {0.5 mul} bind def  % Length of side of each pixel

/cm {28.35 mul} bind def
/a4width 21 cm def
/a4height 29.7 cm def

/dup2 { % x y => x y x y
	dup 3 -1 roll dup 4 1 roll exch
} bind def

/nextiter { % x_n y_n => x_n+1 y_n+1
	exch dup 3 -1 roll % [x_n x_n y_n]
	1 add exch dup mul A mul sub % 1 + y - a*x^2
	exch % [x_n+1 x_n]
	B mul % [x_n+1 y_n+1]
} bind def

/plotpoint { % x y => x y
	dup2 exch
	0.37 mul 0.5 add a4height mul 0.5 pixelside sub exch
	-1.2 mul 0.5 add a4width mul 0.5 pixelside sub exch
	moveto
	1 pixelside 0 pixelside rlineto
	0 pixelside 1 pixelside rlineto
	-1 pixelside 0 pixelside rlineto
	closepath fill stroke
} bind def

newpath

0.0 0.0 % x_0 y_0

1 1 NUMITER {
	pop
	nextiter
	plotpoint
} for

showpage

%%EOF
